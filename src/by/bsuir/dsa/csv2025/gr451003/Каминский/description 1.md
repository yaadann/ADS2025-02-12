# Название

Минимальные остовные деревья в компонентах связности

# Описание

Минимальные остовные деревья в компонентах связности

## Описание
В неориентированном графе компонентой связности называется множество вершин, между которыми существует путь. Если граф состоит из нескольких компонент связности, то минимальное остовное дерево можно построить только внутри каждой отдельной компоненты.

Минимальное остовное дерево (МОСТ) — это остовное дерево, суммарный вес рёбер которого минимален среди всех возможных остовных деревьев данной компоненты.

В этом задании вам необходимо:
1. Найти все компоненты связности неориентированного графа.
2. Для каждой компоненты связности построить её минимальное остовное дерево.
3. Вычислить и вывести суммарный вес всех минимальных остовных деревьев графа.

---

## Формат входных данных
Первая строка содержит два числа:
- `n` — количество вершин,
- `m` — количество рёбер.

Следующие `m` строк содержат тройки чисел:
`u v w` — ребро между вершинами `u` и `v` весом `w`.

Гарантируется, что:
- граф неориентированный,
- веса рёбер положительные.

---

## Требования к решению
### 1. Поиск компонент связности
Необходимо выполнить обход графа (DFS или BFS), присваивая каждой вершине номер её компоненты.

Результат этапа:
- количество компонент связности,
- номер компоненты для каждой вершины.

### 2. Построение минимального остовного дерева
Для каждой компоненты связности необходимо:
- выделить рёбра, принадлежащие этой компоненте,
- построить минимальное остовное дерево (алгоритм Прима или Крускала),
- вычислить вес полученного дерева.

Итоговый ответ — сумма весов всех минимальных остовных деревьев графа.

---

## Ограничения
- `1 ≤ n ≤ 10^5`
- `0 ≤ m ≤ 2 * 10^5`
- `1 ≤ w ≤ 10^9`

Ожидаемая асимптотика:  
`O(n + m) + O(m log m)`.

---

## Пример
**Входные данные:**
6 4
1 2 5
2 3 7
4 5 2
5 6 3

**Выходные данные:**
2
17

# Краткая теория

Минимальное остовное дерево в компоненте связности

## Определения

**Остовным деревом** неориентированного графа называется подграф, содержащий все его вершины и не содержащий циклов. Если граф несвязный, то остовное дерево существует только для каждой отдельной компоненты связности.

**Минимальным остовным деревом (МОСТ)** называется остовное дерево, суммарный вес рёбер которого минимально возможен.

## Постановка задачи

Дан неориентированный взвешенный граф $G$ с $n$ вершинами и $m$ рёбрами. Требуется:

1. Найти все компоненты связности графа
2. Для каждой компоненты построить её минимальное остовное дерево

## Алгоритм решения

### 1. Поиск компонент связности

Поиск компонент связности производится с помощью обхода в глубину (DFS):

```java
final int MAXN = 100000;
int[] comp = new int[MAXN];
List<Integer>[] g;

void dfs(int v, int num) {
    comp[v] = num;
    for (int u : g[v])
        if (comp[u] == 0)
            dfs(u, num);
}
```

Запуск DFS из каждой непосещённой вершины:

```java
int num = 0;
for (int v = 0; v < n; v++)
    if (comp[v] == 0)
        dfs(v, ++num);
```

После завершения:
- `num` — число компонент связности
- `comp[v]` — номер компоненты вершины $v$

**Асимптотика поиска компонент связности:** $O(n + m)$, поскольку каждая вершина и каждое ребро будут рассмотрены ровно один раз.

### 2. Построение минимального остовного дерева

После выделения компонент связности можно независимо построить минимальное остовное дерево в каждой из них.

#### Основные алгоритмы:

1. **Алгоритм Крускала** — сортирует рёбра по весу и добавляет их, если они не создают цикл. Для проверки циклов используется структура DSU (Union-Find).

2. **Алгоритм Прима** — начинает с произвольной вершины компоненты и постепенно добавляет наиболее дешёвое ребро, ведущее в новую вершину.

#### Принцип построения МОСТ:

Из множества всех остовных деревьев выбирается то, у которого суммарный вес минимален:

$$
W = \min \sum w_i
$$

## Асимптотика

- **Алгоритм Крускала:** $O(m \log m)$ (из-за сортировки рёбер)
- **Алгоритм Прима с бинарной кучей:** $O(m \log n)$

Так как граф может быть несвязным, минимальное остовное дерево строится отдельно для каждой компоненты связности. Суммарный вес всех МОСТ вычисляется как:

$$
W_{total} = \sum_{i=1}^{k} W_i
$$

где $k$ — число компонент связности.

## Итоговая асимптотика

$$
O(n + m) + \sum O(m_i \log n_i)
$$


