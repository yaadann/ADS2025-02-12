# Название

Хеширование подстрок и сравнение строк

# Описание

---

title: Хеширование подстрок и сравнение строк
weight: 3
authors:

* AntonRadzko
  created: 2025

---

# Хеширование подстрок и сравнение строк

Дана строка s длины n. Необходимо обработать q запросов двух типов:

1. **`1 l r`** — вычислить полиномиальный хеш подстроки s[l..r] по модулю 2^64.
2. **`2 a b c d`** — определить, равны ли подстроки s[a..b] и s[c..d], используя только их хеши.

Вам необходимо:

* построить массив префиксных хешей строки,
* подготовить степени выбранного основания k,
* уметь получать хеш любой подстроки за O(1) после предварительной обработки.

## Краткая теория

Полиномиальный хеш строки строится с использованием выбранного основания k и накопления хеша слева направо. Модуль 2^64 достигается автоматически за счёт переполнения типа unsigned long long.

Хеш подстроки можно получить через разницу префиксных хешей с учётом длины подстроки.

## Формат ввода

```
n q
s
<q запросов>
```

## Формат вывода

* Для запроса типа `1` — одно число: хеш подстроки.
* Для запроса типа `2` — `YES`, если подстроки равны, иначе `NO`.

---

## Задание

Реализуйте полиномиальное хеширование и обработайте все запросы.

# Краткая теория

## Краткая теория 

Полиномиальный хеш строки определяется формулой:

$$
H(s) = (s_1 k^{n-1} + s_2 k^{n-2} + ... + s_n) mod\ m
$$

Хеш подстроки вычисляется через префиксные хеши:

$$
H(l, r) = H[r] - H[l-1] * k^{(r-l+1)}
$$

---

