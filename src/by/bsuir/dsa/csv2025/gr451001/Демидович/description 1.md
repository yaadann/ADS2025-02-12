# Название

Барабанная Дробь с Эхом

# Описание

Барабанная Дробь с Эхом

## Сценарий

Вы играете на двух барабанах — **Левом ('L')** и **Правом ('R')** — в помещении с очень сильной и быстрой акустикой. Ваши действия записывает чувствительный микрофон.

## Условие

Каждый удар, который вы наносите по барабану, из-за специфической **реверберации** в помещении, может быть зафиксирован микрофоном по-разному:
1.  **Один раз:** Слышен только сам удар (например, 'L').
2.  **Два раза:** Удар и немедленно следующее за ним эхо фиксируются как два отдельных, одинаковых звука (например, 'LL').

Вам даны две записи:
1.  **$P$ (Партитура)** — точная последовательность ударов, которые вы нанесли.
2.  **$S$ (Запись)** — фактическая последовательность звуков, которую зафиксировал микрофон.

**Задача:** Определите, могла ли последовательность $S$ быть получена в результате ваших ударов $P$ в этом помещении.

# Краткая теория

## Суть проблемы

Задача состоит в проверке, может ли **последовательность звуков $S$** быть порождена **последовательностью ударов $P$**, учитывая, что каждый удар $X \in \{\text{'L'}, \text{'R'}\}$ может привести к $X$ или $XX$.

## Ключевое наблюдение

Свойство расширения $X \to \{X, XX\}$ гарантирует, что тип барабана ('L' или 'R') не может измениться при ударе.
1.  Удар **'L'** может породить только 'L' или 'LL'.
2.  Удар **'R'** может породить только 'R' или 'RR'.

Это означает, что **структура чередования** блоков одинаковых символов в $P$ и $S$ должна быть идентична.



---

## Метод решения: Анализ блоков (RLE)

Для решения задачи мы используем **Кодирование длин серий (Run-Length Encoding, RLE)** для преобразования обеих строк ($P$ и $S$) в последовательности блоков.

### 1. Разбиение на блоки

Строки $P$ и $S$ разбиваются на максимальные группы подряд идущих одинаковых символов.
Пусть $P = P_1 P_2 \ldots P_k$ и $S = S_1 S_2 \ldots S_m$, где $P_i$ и $S_i$ — блоки.

* **Пример:** $P = \text{"LLRLL"}$ разбивается на 3 блока: $P_1 = \text{"LL"}$ (L, 2), $P_2 = \text{"R"}$ (R, 1), $P_3 = \text{"LL"}$ (L, 2).

### 2. Проверка соответствия

Проверка осуществляется в три этапа:

**A. Количество блоков**

Количество блоков в $P$ должно совпадать с количеством блоков в $S$.
$$
k = m
$$
Если $k \ne m$, строка $S$ не могла быть полуждена из $P$, и ответ — **NO**.

**B. Тип блоков**

Для каждого $i$ от $1$ до $k$, тип символа в блоке $P_i$ должен совпадать с типом символа в блоке $S_i$.
$$
\text{type}(P_i) = \text{type}(S_i)
$$
Если $\text{type}(P_i) \ne \text{type}(S_i)$ (например, $P_i$ — это 'L', а $S_i$ — 'R'), ответ — **NO**.

**C. Диапазон длин**

Длина каждого блока в $S$ должна быть **расширением** соответствующего блока в $P$. Если $P_i$ состоит из $L_P$ одинаковых символов, то $L_P$ ударов должно было породить $L_S$ звуков в $S_i$. Поскольку каждый из $L_P$ ударов мог дать $1$ или $2$ звука:
* Минимальная длина $L_S$: все удары дали 1 звук $\implies L_S = L_P$.
* Максимальная длина $L_S$: все удары дали 2 звука $\implies L_S = 2 L_P$.

Таким образом, для каждого блока $i$ должно выполняться:
$$
|P_i| \le |S_i| \le 2|P_i|
$$
Если хотя бы для одного блока это неравенство нарушается, ответ — **NO**.

Если все три условия (A, B, C) соблюдены для всех блоков, ответ — **YES**.

---

## Реализация

Метод RLE эффективно реализуется за линейное время $O(|P| + |S|)$ с использованием подхода **двух указателей** или **итеративного прохода** по строке для сбора блоков.

| Случай | P | S | $|P_i|$ | $|S_i|$ | Результат |
| :---: | :---: | :---: | :---: | :---: | :---: |
| ✅ Min. расширение | `RR` | `RR` | 2 | 2 | YES ($2 \le 2 \le 4$) |
| ✅ Max. расширение | `R` | `RR` | 1 | 2 | YES ($1 \le 2 \le 2$) |
| ❌ Недостаток | `LL` | `L` | 2 | 1 | NO ($1 < 2$) |
| ❌ Избыток | `R` | `RRR` | 1 | 3 | NO ($3 > 2$) |
| ❌ Структура | `LR` | `LRRRL` | $L(1) R(1)$ | $L(1) R(3) L(1)$ | NO (2 блока $\ne$ 3 блока) |

