# –ù–∞–∑–≤–∞–Ω–∏–µ

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ü–æ—Ç–æ–∫

# –û–ø–∏—Å–∞–Ω–∏–µ

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ü–æ—Ç–æ–∫.

**–£—Å–ª–æ–≤–∏–µ –ó–∞–¥–∞—á–∏ (–ö–ª–∞—Å—Å FlowC):**
–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å `FlowC` —Å –º–µ—Ç–æ–¥–æ–º `main`, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—á–∏—Å–ª—è–µ—Ç **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ü–æ—Ç–æ–∫ (Max Flow)** –º–µ–∂–¥—É –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –≤–µ—Ä—à–∏–Ω–∞–º–∏ –ò—Å—Ç–æ—á–Ω–∏–∫–∞ (**Source**) –∏ –°—Ç–æ–∫–∞ (**Sink**) –≤ –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≥—Ä–∞—Ñ–µ —Å –ø—Ä–æ–ø—É—Å–∫–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏ –Ω–∞ —Ä—ë–±—Ä–∞—Ö.

## üì• –í—Ö–æ–¥–Ω—ã–µ –î–∞–Ω–Ω—ã–µ

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞ (`System.in`):

1.  **–°—Ç—Ä–æ–∫–∞ 1 (–ì—Ä–∞—Ñ):** –†—ë–±—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `–£–∑–µ–ª_–æ—Ç–ø—Ä–∞–≤–∫–∏-–£–∑–µ–ª_–ø—Ä–∏—ë–º–∞:–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è_—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å`. –†—ë–±—Ä–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –∑–∞–ø—è—Ç–æ–π (—Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –ø—Ä–æ–±–µ–ª–æ–º).
2.  **–°—Ç—Ä–æ–∫–∞ 2 (Source –∏ Sink):** –ò–º–µ–Ω–∞ –ò—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –°—Ç–æ–∫–∞, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª–æ–º.

## 1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ê–ª–≥–æ—Ä–∏—Ç–º—É

* **–ê–ª–≥–æ—Ä–∏—Ç–º:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º **–≠–¥–º–æ–Ω–¥—Å–∞-–ö–∞—Ä–ø–∞ (Edmonds-Karp)**.
* **–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≥—Ä–∞—Ñ:** –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–µ –ø—Ä—è–º–æ–µ —Ä–µ–±—Ä–æ $(u \to v)$ –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ **–æ–±—Ä–∞—Ç–Ω–æ–µ —Ä–µ–±—Ä–æ** $(v \to u)$ —Å –Ω—É–ª–µ–≤–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é.
* **–ò—Ç–µ—Ä–∞—Ü–∏–∏:** –í —Ü–∏–∫–ª–µ `while` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–û–±—Ö–æ–¥ –≤ –®–∏—Ä–∏–Ω—É (BFS)** –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—É—Ç–∏ (**Augmenting Path**) –æ—Ç Source –¥–æ Sink.
* **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ï—Å–ª–∏ –ø—É—Ç—å –Ω–∞–π–¥–µ–Ω:
    * –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ **–º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (bottleneck)** –Ω–∞ –ø—É—Ç–∏.
    * –û–±–Ω–æ–≤–∏—Ç–µ –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≥—Ä–∞—Ñ: —É–º–µ–Ω—å—à–∏—Ç–µ —ë–º–∫–æ—Å—Ç—å –ø—Ä—è–º—ã—Ö —Ä—ë–±–µ—Ä –∏ —É–≤–µ–ª–∏—á—å—Ç–µ —ë–º–∫–æ—Å—Ç—å –æ–±—Ä–∞—Ç–Ω—ã—Ö —Ä—ë–±–µ—Ä –Ω–∞ —ç—Ç—É –≤–µ–ª–∏—á–∏–Ω—É.

## 2. –í—ã–≤–æ–¥

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–≤–µ—Å—Ç–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ ‚Äî –≤–µ–ª–∏—á–∏–Ω—É **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ü–æ—Ç–æ–∫–∞** (`System.out.print()`).

## 3. –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –æ—à–∏–±–∫–∞–º –ø–∞—Ä—Å–∏–Ω–≥–∞ (–ø—Ä–æ–±–µ–ª—ã, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏).

# –ö—Ä–∞—Ç–∫–∞—è —Ç–µ–æ—Ä–∏—è

–ó–∞–¥–∞—á–∞ –æ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º –ü–æ—Ç–æ–∫–µ (Max Flow)** —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∞–µ—É–≥–æ–ª—å–Ω–æ–π –≤ —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤. –û–Ω–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ –ø–æ–∏—Å–∫–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–π –≤–µ–ª–∏—á–∏–Ω—ã –ø–æ—Ç–æ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –æ—Ç –æ–¥–Ω–æ–π –≤–µ—Ä—à–∏–Ω—ã, –Ω–∞–∑—ã–≤–∞–µ–º–æ–π **–ò—Å—Ç–æ—á–Ω–∏–∫–æ–º (Source, $s$)**, –¥–æ –¥—Ä—É–≥–æ–π, –Ω–∞–∑—ã–≤–∞–µ–º–æ–π **–°—Ç–æ–∫–æ–º (Sink, $t$)**, —á–µ—Ä–µ–∑ —Å–µ—Ç—å, —Ä—ë–±—Ä–∞ –∫–æ—Ç–æ—Ä–æ–π –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é **–ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (Capacity)**.

–û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–∏–Ω—Ü–∏–ø: –ø–æ—Ç–æ–∫, –≤—Ö–æ–¥—è—â–∏–π –≤ –ª—é–±—É—é –≤–µ—Ä—à–∏–Ω—É (–∫—Ä–æ–º–µ $s$ –∏ $t$), –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω –ø–æ—Ç–æ–∫—É, –≤—ã—Ö–æ–¥—è—â–µ–º—É –∏–∑ –Ω–µ—ë (–∑–∞–∫–æ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞).

## –ê–ª–≥–æ—Ä–∏—Ç–º –≠–¥–º–æ–Ω–¥—Å–∞-–ö–∞—Ä–ø–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º –≠–¥–º–æ–Ω–¥—Å–∞-–ö–∞—Ä–ø–∞** ‚Äî —ç—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–æ–ª–µ–µ –æ–±—â–µ–≥–æ **–ú–µ—Ç–æ–¥–∞ –§–æ—Ä–¥–∞-–§–∞–ª–∫–µ—Ä—Å–æ–Ω–∞**. –û–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—É—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ **–û–±—Ö–æ–¥ –≤ –®–∏—Ä–∏–Ω—É (BFS)**. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BFS –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–∞–∂–¥—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–π –ø—É—Ç—å –∏–º–µ–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä—ë–±–µ—Ä, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞: $O(V E^2)$, –≥–¥–µ $V$ ‚Äî —á–∏—Å–ª–æ –≤–µ—Ä—à–∏–Ω, $E$ ‚Äî —á–∏—Å–ª–æ —Ä—ë–±–µ—Ä.



### –û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –ì—Ä–∞—Ñ ($G_f$)

–ö–ª—é—á–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —è–≤–ª—è–µ—Ç—Å—è **–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –ì—Ä–∞—Ñ** ($G_f$). –≠—Ç–æ—Ç –≥—Ä–∞—Ñ –æ—Ç—Ä–∞–∂–∞–µ—Ç *–¥–æ—Å—Ç—É–ø–Ω—É—é* –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç "–æ—Ç–º–µ–Ω—è—Ç—å" —Ä–∞–Ω–µ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –æ–±—â–∏–π –ø—É—Ç—å, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ö–æ–¥–∏—Ç —É–∑–∫–∏–µ –º–µ—Å—Ç–∞.

* **–ü—Ä—è–º–æ–µ —Ä–µ–±—Ä–æ ($u \to v$):** –û—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å $c_f(u, v) = c(u, v) - f(u, v)$, –≥–¥–µ $f(u, v)$ ‚Äî —Ç–µ–∫—É—â–∏–π –ø–æ—Ç–æ–∫.
* **–û–±—Ä–∞—Ç–Ω–æ–µ —Ä–µ–±—Ä–æ ($v \to u$):** –û—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å $c_f(v, u) = f(u, v)$. –û–Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Ä–Ω—É—Ç—å (–æ—Ç–º–µ–Ω–∏—Ç—å) –ø–æ—Ç–æ–∫, —Ä–∞–Ω–µ–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ –ø—Ä—è–º–æ–º—É —Ä–µ–±—Ä—É. –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –æ–±—Ä–∞—Ç–Ω—ã–µ —Ä—ë–±—Ä–∞ –∏–º–µ—é—Ç $c_f=0$.

### –ò—Ç–µ—Ä–∞—Ü–∏–∏

–ê–ª–≥–æ—Ä–∏—Ç–º –≠–¥–º–æ–Ω–¥—Å–∞-–ö–∞—Ä–ø–∞ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–µ –ø—É—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≥—Ä–∞—Ñ:

1.  **–ü–æ–∏—Å–∫ —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–µ–≥–æ –ø—É—Ç–∏:** –ò—Å–ø–æ–ª—å–∑—É—è **BFS**, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª—é–±–æ–π –ø—É—Ç—å $P$ –æ—Ç $s$ –¥–æ $t$ –≤ $G_f$, —Å–æ—Å—Ç–æ—è—â–∏–π —Ç–æ–ª—å–∫–æ –∏–∑ —Ä—ë–±–µ—Ä —Å –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é $c_f(u, v) > 0$.
2.  **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ–ª–∏—á–∏–Ω—ã –ø–æ—Ç–æ–∫–∞ ($\delta$):** –ù–∞—Ö–æ–¥–∏—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (bottleneck) –Ω–∞ –ø—É—Ç–∏ $P$:
    $$\delta = \min_{(u,v) \in P} c_f(u,v)$$
3.  **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞:** –ü–æ—Ç–æ–∫ $\delta$ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –æ–±—â–µ–º—É –ø–æ—Ç–æ–∫—É, –∞ –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –≥—Ä–∞—Ñ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:
    * **–ü—Ä—è–º–æ–µ —Ä–µ–±—Ä–æ:** $c_f(u, v) \leftarrow c_f(u, v) - \delta$
    * **–û–±—Ä–∞—Ç–Ω–æ–µ —Ä–µ–±—Ä–æ:** $c_f(v, u) \leftarrow c_f(v, u) + \delta$
4.  –¶–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –ø–æ–∫–∞ BFS –Ω–∞—Ö–æ–¥–∏—Ç –ø—É—Ç—å —Å $\delta > 0$.

## –¢–µ–æ—Ä–µ–º–∞ –æ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º –ü–æ—Ç–æ–∫–µ –∏ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –†–∞–∑—Ä–µ–∑–µ

–°—Ö–æ–¥–∏–º–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è **–¢–µ–æ—Ä–µ–º–æ–π –æ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º –ü–æ—Ç–æ–∫–µ –∏ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–º –†–∞–∑—Ä–µ–∑–µ (Max-Flow Min-Cut Theorem)**.

**–†–∞–∑—Ä–µ–∑ $(S, T)$** ‚Äî —ç—Ç–æ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω –≥—Ä–∞—Ñ–∞ –Ω–∞ –¥–≤–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ $S$ –∏ $T$, –≥–¥–µ $s \in S$ –∏ $t \in T$.

**–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–µ–∑–∞ $c(S, T)$** ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Ä—ë–±–µ—Ä, –∏–¥—É—â–∏—Ö –∏–∑ $S$ –≤ $T$.

$$\text{Max Flow} = \text{Min Cut}$$

–≠—Ç–∞ —Ç–µ–æ—Ä–µ–º–∞ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–∑ $s$ –≤ $t$, –≤—Å–µ–≥–¥–∞ —Ä–∞–≤–µ–Ω –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–∞—Ä–Ω–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ª—é–±–æ–≥–æ —Ä–∞–∑—Ä–µ–∑–∞, —Ä–∞–∑–¥–µ–ª—è—é—â–µ–≥–æ $s$ –∏ $t$. –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ–∑–∞ —è–≤–ª—è–µ—Ç—Å—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

