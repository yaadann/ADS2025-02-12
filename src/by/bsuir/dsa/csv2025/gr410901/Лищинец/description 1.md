# Название

Сжатие координат

# Описание

Сжатие координат для оптимизации запросов к базе данных

## Описание проблемы
В системе геоаналитики есть база данных, которая хранит координаты объектов на карте. Координаты представлены в виде целых чисел (например, метры от некоторого начала отсчета), но их диапазон очень велик - от -10^9 до 10^9. При этом количество уникальных координат не превышает 10^5.

Для оптимизации запросов к базе данных и уменьшения использования памяти необходимо реализовать алгоритм сжатия координат (coordinate compression).

## Постановка задачи
Реализуйте класс `CoordinateCompressor`, который выполняет сжатие координат и поддерживает следующие операции:

- **Добавление координат** - регистрация координат для последующего сжатия
- **Сжатие координаты** - преобразование исходной координаты в ее сжатый индекс
- **Восстановление координаты** - получение исходной координаты по сжатому индексу
- **Получение диапазона** - определение границ сжатых координат для заданного диапазона исходных координат

## Технические требования
- Координаты представляются как целые числа (`long`)
- После добавления всех координат необходимо вызвать метод `compress()` для выполнения сжатия
- Сжатые индексы должны быть в диапазоне [0, n-1], где n - количество уникальных координат
- Порядок координат должен сохраняться: если coord1 < coord2, то compressed(coord1) < compressed(coord2)
- Методы сжатия/восстановления должны работать за O(log n)
- Класс должен быть потокобезопасным для однопоточной работы

## Методы класса

### Конструкторы
- `CoordinateCompressor()` - создает пустой компрессор
- `CoordinateCompressor(Collection<Long> initialCoordinates)` - создает компрессор с начальным набором координат

### Основные методы
- `boolean addCoordinate(long coordinate)` - добавляет координату
- `void addCoordinates(long[] coordinates)` - добавляет массив координат
- `void compress()` - выполняет сжатие координат
- `int compressCoordinate(long coordinate)` - сжимает координату
- `long restoreCoordinate(int compressedIndex)` - восстанавливает координату
- `int[] getCompressedRange(long from, long to)` - находит сжатый диапазон

### Вспомогательные методы
- `int size()` - возвращает количество уникальных координат
- `boolean isCompressed()` - проверяет, выполнено ли сжатие
- `void clear()` - очищает компрессор

## Практическое применение
Такой алгоритм используется в:
- Геоинформационных системах (GIS)
- Базах данных для оптимизации индексов
- Алгоритмах обработки больших массивов данных
- Computer graphics и игровых движках
- Системах аналитики и визуализации данных

## Пример использования
```java
CoordinateCompressor compressor = new CoordinateCompressor();
compressor.addCoordinate(1000L);
compressor.addCoordinate(100L);
compressor.addCoordinate(10L);
compressor.compress();

int index = compressor.compressCoordinate(100L); // вернет 1
long coord = compressor.restoreCoordinate(0);    // вернет 10L
```


# Краткая теория

Сжатие координат (Coordinate Compression)

**Сжатие координат** — это техника, используемая для уменьшения диапазона значений при сохранении их относительного порядка. Особенно полезна при работе с большими числами, когда количество уникальных значений значительно меньше их диапазона.

## Основная идея

Пусть есть массив координат с большим диапазоном:
```
Исходные координаты: [1000, -5000000, 1000, 250000000, -5000000]
```

После сжатия получаем:
```
Сжатые индексы: [1, 0, 1, 2, 0]
Уникальные значения: [-5000000, 1000, 250000000]
```

## Алгоритм

1. **Сбор уникальных координат** — сохраняем все различные значения
2. **Сортировка** — упорядочиваем значения по возрастанию
3. **Сопоставление** — каждому исходному значению ставим в соответствие его индекс в отсортированном массиве

## Сложность

- **Время**: O(n log n) для сортировки, O(log n) для запросов
- **Память**: O(n) для хранения уникальных значений

## Применение

- **Геоинформационные системы** — сжатие GPS координат
- **Базы данных** — оптимизация индексов для sparse данных
- **Обработка запросов** — преобразование диапазонов
- **Computer graphics** — работа с большими координатными пространствами

## Ключевые свойства

- **Сохраняет порядок**: если a < b, то compressed(a) < compressed(b)
- **Обратимость**: можно восстановить исходное значение по индексу
- **Эффективность**: уменьшает потребление памяти при работе с sparse данными


