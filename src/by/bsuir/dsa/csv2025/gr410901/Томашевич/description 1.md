# Название

Построение минимального остовного дерева (Алгоритм Краскала)

# Описание

## Построение минимального остовного дерева (Алгоритм Краскала) #

# Краткая теория

Теория: Минимальное остовное дерево (MST), алгоритм Краскала и DSU

## 1. Минимальное остовное дерево (Minimum Spanning Tree, MST)

Пусть дан связный неориентированный граф, у которого есть `n` вершин и `m` рёбер.  
Каждое ребро имеет вес.

**Минимальное остовное дерево (MST)** — это набор из `n−1` рёбер, который:

- соединяет все вершины (граф становится связным),
- не содержит циклов,
- имеет минимальную возможную сумму весов.

Применяется в реальных задачах: построение минимальной стоимости сетей (оптоволокно, дороги, электросети, коммуникации).

---

## 2. Алгоритм Краскала

Алгоритм Краскала — один из самых популярных способов найти MST.

Основная идея:

1. **Отсортировать рёбра по весу (по возрастанию).**
2. **Идти от самых лёгких рёбер к тяжёлым.**
3. Добавлять ребро в остов, если оно **не образует цикл**.
4. Чтобы быстро определить наличие цикла — используется структура DSU.

Если после обработки всех рёбер оказалось, что число компонент > 1,  
значит граф был изначально несвязным → MST не существует.

### Время работы:
- сортировка рёбер: `O(m log m)`
- DSU-операции: почти `O(1)` амортизированно  
  Итого: **O(m log m)**

---

## 3. DSU (Disjoint Set Union) — система непересекающихся множеств

DSU хранит разбиение множества вершин на компоненты.

Поддерживает две операции:

### ● `find(x)`
Находит корневого представителя множества.  
Используется **сжатие пути (path compression)**: ускоряет последующие запросы.

### ● `union(x, y)`
Объединяет множества, в которых находятся `x` и `y`.  
Реализация использует **union by rank** — всегда прикрепляет более низкое дерево к высокому.

### Применение DSU в Краскале

Перед добавлением ребра `(u, v)`:
- если `find(u) != find(v)` → ребро **можно** добавить без цикла
- иначе — появится **цикл**, ребро пропускается

---

## 4. Признаки несвязного графа

Если после обработки рёбер осталось больше чем 1 компонент, то MST построить нельзя.  
В задаче это обозначается выводом:

GRAPH IS NOT CONNECTED


---

## 5. Особенности реализации

- Алгоритм работает даже с отрицательными весами.
- При `n = 0` или `n = 1` сумма MST равна `0`.
- Граф может быть полностью, частично или не соединён вовсе.
- Краскал подходит, когда рёбер много (особенно если они уже отсортированы).

---

## 6. Итог

Алгоритм Краскала + DSU — это быстрый и надёжный способ построения  
минимального остовного дерева, который широко используется в реальных задачах оптимизации сетей.

