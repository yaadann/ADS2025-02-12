# Название

 Префикс-функция

# Описание

Компания разрабатывает систему быстрого поиска шаблонов в больших текстах.  
Для оптимизации поиска требуется вычислять **префикс-функцию** строки — массив  
$$
\pi[i],
$$
где каждое значение показывает длину наибольшего собственного суффикса подстроки  
$$
s[0..i],
$$  
который одновременно является её префиксом.

Напишите программу, которая считывает строку $$s$$, вычисляет массив префикс-функции $$\pi$$ и выводит его значения через пробел.

# Краткая теория

Теория

Префикс-функция строки — это ключевой инструмент в строковых алгоритмах, особенно в алгоритме Кнута–Морриса–Пратта (КМП). Она позволяет эффективно находить повторяющиеся структуры в строке и использовать их для оптимизации поиска подстрок.

Пусть дана строка  
$$
s = s_0 s_1 \dots s_{n-1},
$$

и нужно построить массив  
$$
\pi = (\pi_0, \pi_1, \dots, \pi_{n-1}),
$$

где каждое значение  
$$
\pi_i
$$  
— это длина наибольшего собственного префикса строки  
$$
s[0..i],
$$  
который одновременно является её суффиксом.

То есть  
$$
\pi_i = \max\{k : s[0..k-1] = s[i-k+1..i]\}.
$$

---

## Как вычисляется префикс-функция

Для каждого i мы пытаемся расширить ранее найденный бордер π[i−1].

Пусть  
$$
j = \pi_{i-1}
$$  
— длина наибольшего префикс-суффикса для предыдущего индекса.

Теперь проверяем символы:


### **1) Если совпадают:**

Если  
$$
s[i] = s[j],
$$  

то можно расширить совпадение:  
$$
\pi_i = j + 1.
$$



### **2) Если НЕ совпадают:**

Если  
$$
s[i] \ne s[j],
$$  
то "откатываемся" к:

$$
j = \pi_{j-1},
$$

и пробуем снова.



### **3) Если j стал 0, и совпадения нет:**

$$
\pi_i = 0.
$$



Таким образом, при вычислении каждого значения π мы переходим только по заранее найденным границам, что обеспечивает **линейную сложность** алгоритма.


## Сложность алгоритма

Префикс-функция вычисляется за:  
$$
O(n),
$$

потому что каждый символ строки рассматривается не более двух раз:  
— один раз при продвижении i,  
— второй раз при откате j.

## Где применяется префикс-функция?

 1. Алгоритм КМП (поиск подстроки за O(n))
Позволяет находить подстроку t в тексте s без откатов назад.

 2. Нахождение периодов строки. Строка имеет период p, если:

$$
n \bmod (n - \pi_{n-1}) = 0.
$$

 3. Подсчёт количества вхождений префикса в суффиксах

 4. Используется в динамическом программировании для оптимизации работы со строками по строкам и оптимизациях

 5. Вычисление бордеров

