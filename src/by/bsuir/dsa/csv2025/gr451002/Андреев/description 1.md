# Название

Оптимальный набор проектов

# Описание

Оптимальный набор проектов

## Условие задачи

Компания имеет бюджет в размере 1,000,000$ и должна выбрать из n доступных проектов для инвестирования. Каждый проект имеет:

- `cost[i]` - стоимость реализации проекта
- `profit[i]` - ожидаемая прибыль от проекта
- `manpower[i]` - требуемое количество сотрудников

### Ограничения:

1. Общая стоимость выбранных проектов не должна превышать бюджет (1,000,000$)
2. Общее количество задействованных сотрудников не должно превышать 50 человек
3. Можно выбрать либо весь проект, либо не выбирать (дробные проекты не допускаются)

### Цель:

Максимизировать общую прибыль при соблюдении ограничений.

## Математическая формулировка

Пусть:
- `x[i] ∈ {0, 1}` - бинарная переменная (1 - проект выбран, 0 - не выбран)
- `C = 1,000,000` - бюджет
- `M = 50` - максимальное количество сотрудников

**Задача оптимизации:**

Максимизировать: `∑(profit[i] * x[i])`

При ограничениях:
- `∑(cost[i] * x[i]) ≤ C`
- `∑(manpower[i] * x[i]) ≤ M`
- `x[i] ∈ {0, 1}` для всех i

## Требования

1. Изучить теоретические основы задачи о рюкзаке с несколькими ограничениями
2. Изучить дискретный метод Лагранжа для решения задач целочисленного программирования
3. Разработать алгоритм решения задачи с использованием дискретного метода Лагранжа
4. Привести примеры работы алгоритма на различных наборах данных

## Формат решения

- Математическое описание дискретного метода Лагранжа
- Алгоритм решения задачи
- Примеры для различных наборов проектов
- Анализ вычислительной сложности

---

### Особенности этой задачи:

- **Задача о рюкзаке с двумя ограничениями** - классическая задача дискретной оптимизации
- **Дискретный метод Лагранжа** - эвристический метод для приближенного решения задач целочисленного программирования
- **Практическая применимость** - задача имеет множество приложений в бизнесе и экономике
- **Хороша для изучения** - позволяет понять основы методов оптимизации с ограничениями

Эта задача отлично подходит для изучения методов дискретной оптимизации и эвристических алгоритмов.


# Краткая теория


# Оптимальный набор проектов: дискретный метод Лагранжа

## Условие задачи

Компания имеет бюджет в размере 1,000,000$ и должна выбрать из n доступных проектов для инвестирования. Каждый проект имеет стоимость реализации, ожидаемую прибыль и требуемое количество сотрудников.

**Ограничения:**
- Общая стоимость выбранных проектов ≤ 1,000,000$
- Общее количество сотрудников ≤ 50
- Каждый проект либо выбирается полностью, либо не выбирается

**Цель:** Максимизировать общую прибыль.

## Теоретический анализ

### Постановка задачи как задачи целочисленного программирования

Формально задача формулируется следующим образом:

**Максимизировать:**
```
Z = ∑(i=1 to n) profit[i] * x[i]
```

**При ограничениях:**
```
∑(i=1 to n) cost[i] * x[i] ≤ C
∑(i=1 to n) manpower[i] * x[i] ≤ M
x[i] ∈ {0, 1}, i = 1, 2, ..., n
```

где:
- `x[i]` - бинарная переменная (1 если проект выбран, 0 иначе)
- `C = 1,000,000` - бюджет
- `M = 50` - максимальное количество сотрудников

### Связь с задачей о рюкзаке

Данная задача является обобщением классической задачи о рюкзаке (0-1 Knapsack Problem) с двумя ограничениями вместо одного. Это делает задачу NP-трудной, что означает, что точное решение для больших n требует экспоненциального времени.

### Дискретный метод Лагранжа

Дискретный метод Лагранжа - это эвристический метод для решения задач целочисленного программирования с ограничениями. Основная идея заключается в преобразовании задачи с ограничениями в задачу без ограничений путем введения множителей Лагранжа.

#### Построение лагранжиана

Для нашей задачи лагранжиан имеет вид:

```
L(x, λ₁, λ₂) = ∑(profit[i] * x[i]) 
               - λ₁ * (∑(cost[i] * x[i]) - C)
               - λ₂ * (∑(manpower[i] * x[i]) - M)
```

где `λ₁ ≥ 0` и `λ₂ ≥ 0` - множители Лагранжа.

После преобразования получаем:

```
L(x, λ₁, λ₂) = ∑(profit[i] * x[i]) 
               - λ₁ * ∑(cost[i] * x[i]) 
               - λ₂ * ∑(manpower[i] * x[i])
               + λ₁ * C + λ₂ * M
```

Поскольку последние два слагаемых не зависят от x, задача максимизации эквивалентна максимизации:

```
L'(x, λ₁, λ₂) = ∑((profit[i] - λ₁ * cost[i] - λ₂ * manpower[i]) * x[i])
```

#### Интерпретация множителей Лагранжа

- `λ₁` - "цена" единицы бюджета. Показывает, насколько уменьшится целевая функция при увеличении стоимости на единицу.
- `λ₂` - "цена" единицы рабочей силы. Показывает, насколько уменьшится целевая функция при увеличении количества сотрудников на единицу.

#### Алгоритм дискретного метода Лагранжа

**Шаг 1: Инициализация**
- Выбрать начальные значения множителей `λ₁⁽⁰⁾` и `λ₂⁽⁰⁾`
- Установить лучшее решение `x* = ∅`, `Z* = 0`

**Шаг 2: Вычисление модифицированной прибыли**
Для каждого проекта i вычислить:
```
modified_profit[i] = profit[i] - λ₁ * cost[i] - λ₂ * manpower[i]
```

**Шаг 3: Сортировка и жадный выбор**
- Отсортировать проекты по убыванию `modified_profit[i]`
- Жадным алгоритмом выбрать проекты, начиная с наибольшей модифицированной прибыли, пока не нарушатся ограничения

**Шаг 4: Обновление множителей**
Если решение нарушает ограничения, обновить множители:
```
λ₁^(k+1) = max(0, λ₁^(k) + α * (∑cost[i] * x[i] - C))
λ₂^(k+1) = max(0, λ₂^(k) + α * (∑manpower[i] * x[i] - M))
```
где `α > 0` - шаг обучения.

**Шаг 5: Итерация**
Повторять шаги 2-4 до сходимости или достижения максимального числа итераций.

**Шаг 6: Локальное улучшение**
Применить локальный поиск для улучшения найденного решения:
- Попробовать добавить проекты, которые не были выбраны
- Попробовать заменить выбранные проекты на более прибыльные

### Вычислительная сложность

- **Время:** O(n log n) на итерацию (из-за сортировки) × количество итераций
- **Память:** O(n) для хранения проектов и решения

Для k итераций общая сложность: **O(k * n log n)**

### Теоретические свойства

#### Теорема о двойственности

Для задачи максимизации с ограничениями типа "≤" справедливо:

```
max Z(x) ≤ min L(λ₁, λ₂)
```

где минимум берется по всем неотрицательным `λ₁, λ₂`.

#### Свойство монотонности

При увеличении множителей Лагранжа:
- Уменьшается вероятность выбора дорогих проектов
- Уменьшается вероятность выбора проектов, требующих много сотрудников
- Улучшается соответствие ограничениям

### Обобщения и модификации

#### Множественные ограничения

Метод легко обобщается на случай m ограничений:

```
L(x, λ) = ∑profit[i] * x[i] - ∑(j=1 to m) λⱼ * (∑aⱼᵢ * x[i] - bⱼ)
```

где `aⱼᵢ` - коэффициент j-го ограничения для проекта i, `bⱼ` - правая часть j-го ограничения.

#### Адаптивные шаги обучения

Вместо фиксированного шага `α` можно использовать адаптивные стратегии:
- Уменьшение шага со временем: `α(k) = α₀ / (1 + k)`
- Метод Ньютона для обновления множителей

#### Гибридные методы

Комбинация дискретного метода Лагранжа с другими методами:
- Начальное решение методом Лагранжа, затем точный метод для небольших подзадач
- Использование решения Лагранжа как верхней границы в методе ветвей и границ

## Практические аспекты реализации

### Выбор начальных множителей

Рекомендуемые стратегии:
1. **На основе средних соотношений:**
   ```
   λ₁ = среднее(profit[i] / cost[i]) / 2
   λ₂ = среднее(profit[i] / manpower[i]) / 2
   ```

2. **На основе двойственных оценок:**
   Если доступно решение задачи линейного программирования (релаксации), использовать двойственные переменные.

3. **Итеративный поиск:**
   Пробовать различные комбинации множителей и выбирать лучшую.

### Критерии остановки

1. **Сходимость:** `|λ₁^(k+1) - λ₁^(k)| < ε` и `|λ₂^(k+1) - λ₂^(k)| < ε`
2. **Максимальное число итераций:** k ≥ K_max
3. **Улучшение решения:** нет улучшения в течение N итераций

### Обработка вырожденных случаев

- **Все проекты помещаются:** тривиальное решение - выбрать все
- **Ни один проект не помещается:** пустое решение
- **Одинаковая модифицированная прибыль:** использовать дополнительный критерий (например, отношение прибыль/стоимость)

## Связь с другими методами оптимизации

### Метод ветвей и границ

Дискретный метод Лагранжа может использоваться для получения верхней границы в методе ветвей и границ, что ускоряет поиск точного решения.

### Жадные алгоритмы

Дискретный метод Лагранжа можно рассматривать как обобщение жадного алгоритма, где "жадность" определяется модифицированной прибылью, зависящей от множителей Лагранжа.

### Динамическое программирование

Для небольших задач можно использовать динамическое программирование с двумя измерениями (бюджет и сотрудники), что дает точное решение, но требует O(n * C * M) времени и памяти.

## Заключение

Дискретный метод Лагранжа представляет собой мощный эвристический инструмент для решения задач целочисленного программирования с ограничениями. Хотя он не гарантирует оптимальность решения, он часто дает хорошие приближения за разумное время, что делает его практичным выбором для задач реального мира.

Задача выбора оптимального набора проектов демонстрирует применение метода к практической бизнес-задаче, показывая, как теоретические методы оптимизации могут быть использованы для принятия решений в условиях ограниченных ресурсов.


