# Название

Анализ выигрышных стратегий в игре Ним

# Описание

Анализ выигрышных стратегий в игре Ним

## Условие задачи

Рассматривается классический вариант игры «Ним». Имеется n кучек с камнями, где каждая кучка содержит произвольное количество камней. Два игрока ходят по очереди. Во время своего хода игрок выбирает одну из кучек и убирает из неё любое количество камней (не менее одного). Побеждает игрок, забирающий последний оставшийся камень.

**Задача:**Для произвольной начальной расстановки кучек определить, какой из игроков (ходящий первым или вторым) обладает выигрышной стратегией при условии оптимальной игры обеих сторон.

## Требования

1. Изучить теоретические основы игры Ним
2. Доказать критерий выигрышности позиции
3. Разработать алгоритм определения выигрышной стратегии
4. Привести примеры работы алгоритма

## Формат решения

- Математическое доказательство теоремы
- Алгоритм определения выигрышной стратегии
- Примеры для различных конфигураций

# Краткая теория

Анализ выигрышных стратегий в игре Ним

## Формулировка игры

Рассмотрим игру с $n$ кучками камней, где каждая кучка содержит произвольное количество камней. Игроки ходят по очереди, выбирая одну кучку и удаляя из неё любое ненулевое количество камней. Побеждает игрок, забирающий последний камень.

## Основная теорема

**Теорема.** Позиция является выигрышной тогда и только тогда, когда XOR-сумма размеров кучек отлична от нуля:

$$S = a_1 \oplus a_2 \oplus \ldots \oplus a_n \neq 0$$

### Доказательство

**База индукции:** В терминальном состоянии (все кучки пусты) XOR-сумма равна $0$, и позиция действительно проигрышная.

**Шаг индукции:**

1. **Из проигрышной позиции** ($S = 0$) все ходы ведут в выигрышные позиции. При уменьшении любой кучки $a_i$ до $b_i$ ($b_i < a_i$), XOR-сумма изменяется:

$$S' = 0 \oplus a_i \oplus b_i = a_i \oplus b_i \neq 0$$

2. **Из выигрышной позиции** ($S \neq 0$) существует ход в проигрышную позицию. Выберем старший единичный бит $S$ и найдём кучку $a_i$, у которой этот бит также единичный. Положим:

$$b_i = S \oplus a_i$$

Тогда $b_i < a_i$ и новая XOR-сумма:

$$S' = S \oplus a_i \oplus b_i = S \oplus a_i \oplus (S \oplus a_i) = 0$$

## Оптимальная стратегия

1. Вычислить XOR-сумму всех размеров кучек: $S = a_1 \oplus a_2 \oplus \ldots \oplus a_n$
2. Если $S = 0$, позиция проигрышная
3. Если $S \neq 0$:
   - Найти кучку $a_i$, у которой совпадает старший единичный бит с $S$
   - Уменьшить эту кучку до значения $b_i = S \oplus a_i$

## Модификации игры

### Ним в поддавки (Misère Nim)

В этой версии проигрывает игрок, забирающий последний камень.

**Стратегия:** Аналогична обычному ниму, но с исключением: если все кучки имеют размер $1$, то выигрышность меняется на противоположную.

### Ним Мура ($k$-ним)

Разрешено уменьшать от $1$ до $k$ кучек за один ход.

**Критерий выигрышности:** Для каждого битового разряда вычисляется сумма битов по модулю $(k+1)$. Позиция проигрышная, если все суммы равны нулю.

## Применение и значение

Концепция цугцванга (ситуации, когда любой ход ухудшает позицию) тесно связана с теорией ним-игр. Многие стратегические игры могут быть сведены к эквивалентным ним-конфигурациям, что позволяет анализировать их выигрышные стратегии с помощью XOR-суммирования.

## Примеры

### Пример 1
Кучки: $3, 4, 5$
$$3 \oplus 4 \oplus 5 = (011)_2 \oplus (100)_2 \oplus (101)_2 = (010)_2 = 2 \neq 0$$
**Вывод:** Выигрывает первый игрок.

### Пример 2
Кучки: $1, 2, 3$
$$1 \oplus 2 \oplus 3 = (001)_2 \oplus (010)_2 \oplus (011)_2 = (000)_2 = 0$$
**Вывод:** Выигрывает второй игрок.

