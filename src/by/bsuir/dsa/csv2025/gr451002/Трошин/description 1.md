# Название

Число подпалиндромов

# Описание

Требуется для данной строки размера $n$ определить, сколько её подстрок являются палиндромами.

# Краткая теория

**Палиндромом** называется последовательность символов $a_i$ длины $n$, для которой выполняется $a_i = a_{n-i}$.

Заведем динамику $f[l, r]$, равную единице, если подстрока с $l$ по $r$ является палиндромом, и нулем в противном случае. Посчитав её, мы найдем все подстроки-палиндромы в исходной строке, и для ответа сможем просто просуммировать все ячейки этой динамики.

Определение палиндрома можно альтернативно сформулировать так: строка $s$ является палиндромом, если $s_0 = s_n$ и строка $s_{1\ldots n - 1}$ является палиндромом. Такое определение и будем использовать для пересчета динамики:

$$
f[l, r] = (s_l = s_r) \land f[l + 1, r - 1]
$$

Заведем *двумерный* массив для хранения динамики и пройдемся по базовым случаям: подстрокам размера 1, всегда являющимися палиндромами, и подстрокам размера 2, являющимися палиндромами если первый символ равен второму. Для остальных состояний будем пользоваться формулой выше.

Единственный нюанс — порядок обхода. Нельзя просто проходиться фориком сначала в порядке увеличения $l$, а потом увеличения $r$, потому что пересчет зависит от динамик с большими $l$. Вместо этого будем итерироваться по *размеру* подстроки $d = r - l + 1$, а затем перебирать все подстроки с таким размером. Тогда для любой подстроки динамика для $f[l + 1][r - 1]$ уже будет посчитана.

