# Название

Параллельная обработка заказов в интернет-магазине

# Описание

Задача: Параллельная обработка заказов в интернет-магазине

## Условие

Представьте, что вы работаете в крупном интернет-магазине. Каждый день приходят сотни заказов от покупателей, 
и их нужно быстро обработать — проверить наличие товара, подготовить к отправке, сформировать документы. 
Чтобы справиться с такой нагрузкой, вы решили использовать многопоточную систему обработки.

### Как это работает:

- Каждый заказ обрабатывается отдельно и независимо
- На обработку одного заказа уходит от 100 до 500 миллисекунд (время случайное, как в жизни)
- У вас есть определённое количество "обработчиков" (потоков), которые работают параллельно
- Все заказы должны быть обработаны без ошибок
- В конце нужно посчитать, сколько времени заняла вся работа



# Краткая теория

---
title: Параллельная обработка заказов в интернет-магазине
weight: 1
authors:
- Маргарита Большакова
created: 2025
---

Потоки — один из фундаментальных разделов алгебры графов.  
Интуитивно поток можно представить как количество воды, которое течёт по трубам из источника в сток.  
У каждой трубы есть ограничение: больше определённого количества воды через неё пропустить нельзя.

Формально задача формулируется так: дан ориентированный граф $G = (V, E)$ с двумя выделенными вершинами — 
**истоком** $s$ и **стоком** $t$. Каждому ребру $(u, v)$ сопоставлена **пропускная способность** —
число $c(u, v)$, обозначающее максимальный возможный поток по этому ребру.

Хотим найти функцию $f(u, v)$ — фактический поток, удовлетворяющую следующим условиям.

## Ограничение пропускной способности

Каждое ребро не может передавать больше потока, чем позволяет его пропускная способность:

$$
0 \le f(u, v) \le c(u, v)
$$

## Закон сохранения потока (Кирхгоф)

Для всех вершин, кроме источника $s$ и стока $t$, выполняется:

$$
\sum_{v \in V} f(v, u) = \sum_{v \in V} f(u, v)
$$

Иначе говоря, поток, приходящий в вершину, равен потоку, уходящему из неё.  
Вода не исчезает и ниоткуда не появляется.

## Цель задачи

Мы хотим **максимизировать поток**, который выходит из источника и попадает в сток:

$$
\max \sum_{v \in V} f(s, v)
$$

Такую задачу называют **задачей о максимальном потоке** или **maximum flow problem**.

## Обратные рёбра

Для удобства вводят *обратное ребро* $(v, u)$ с пропускной способностью 0.  
Если по ребру $(u, v)$ течёт поток $f(u, v)$, то по обратному ребру считается:

$$
f(v, u) = -f(u, v)
$$

Это позволяет уменьшать поток по уже выбранным маршрутам.

## Остаточная сеть

Определим остаточную пропускную способность:

$$
c_f(u, v) = c(u, v) - f(u, v)
$$

Если $c_f(u, v) > 0$, то по ребру можно прогнать дополнительный поток.

Идея алгоритмов (Форда–Фалкерсона, Эдмондса–Карпа) заключается в поиске увеличивающих путей —
маршрутов из $s$ в $t$, по которым можно увеличить поток.

## Теорема о максимальном потоке и минимальном разрезе

Одна из важнейших теорем теории графов:

> Максимальный поток равен минимальной пропускной способности разреза $(S, T)$, где $s \in S$, $t \in T$.

То есть чтобы понять, сколько воды можно протолкнуть из дома в реку, нужно найти самое узкое место — 
бутылочное горлышко системы.

## Где используются потоки

* распределение грузов  
* маршрутизация сетевых пакетов  
* планирование производства  
* задачи об оптимальном расписании  


